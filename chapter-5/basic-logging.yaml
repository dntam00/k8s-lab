apiVersion: v1
kind: Pod
metadata:
  name: basicpod
  labels:
    type: webserver
spec:
  containers:
    - name: webcont
      image: nginx
      ports:
        - containerPort: 80
      volumeMounts:
        - mountPath: "/var/log/nginx"
          name: weblog-pv-storage
    - name: fdlogger
      image: fluentd
      env:
        - name: FLUENTD_OPT
          value: -c /fluentd/etc/fluent.conf
      volumeMounts:
        - mountPath: "/var/log"
          name: weblog-pv-storage
        - mountPath: "/fluentd/etc"
          name: fluentd-config

  volumes:
    - name: weblog-pv-storage
      persistentVolumeClaim:
        claimName: weblog-pvc
    - name: fluentd-config
      configMap:
        name: fluentd-config
        defaultMode: 420