###################################
# Generated by confd 2025-03-17 08:30:43.931153003 +0000 UTC m=+0.007524668 #
#             #######             #
#             # k3d #             #
#             #######             #
###################################

error_log stderr notice;

worker_processes auto;
events {
  multi_accept on;
  use epoll;
  worker_connections 1024;
}

stream {

  upstream 6443_tcp {
    server k3d-kaixin-demo-server-0:6443 max_fails=1 fail_timeout=10s;
  }

  server {
    listen        6443;
    proxy_pass    6443_tcp;
    proxy_timeout 600;
    proxy_connect_timeout 2s;
  }

  upstream 80_tcp {
    server k3d-kaixin-demo-agent-0:80 max_fails=1 fail_timeout=10s;
    server k3d-kaixin-demo-agent-1:80 max_fails=1 fail_timeout=10s;
    server k3d-kaixin-demo-server-0:80 max_fails=1 fail_timeout=10s;
  }

  server {
    listen        80;
    proxy_pass    80_tcp;
    proxy_timeout 600;
    proxy_connect_timeout 2s;
  }

}